---
title: è®°ä¸€æ¬¡ç®—æ³•åœ¨å‰ç«¯çš„å®é™…åº”ç”¨
date: 2019-09-11
tags: 
 - ç®—æ³•
---

è¿‘æœŸé‡åˆ°ä¸ªå…³äºæ—¥å†æ–¹é¢çš„éœ€æ±‚ï¼Œæ­£å¥½ç”¨åˆ°äº†ä¸€äº›ç®—æ³•æ–¹é¢çš„çŸ¥è¯†ï¼ŒåŠ¨åŠ¨å°æ‰‹è®°å½•ä¸€ä¸‹æ€è€ƒè¿‡ç¨‹~

<!-- more -->

![æ‰§è¡Œç»“æœ1](/blog/img/date-algo/setWorkDay.jpg)

## éœ€æ±‚æ¦‚è§ˆ

+ å…·ä½“åŠŸèƒ½ï¼šéœ€è¦å®ç°ä¸€ä¸ªæ—¥å†çš„åŠŸèƒ½ï¼Œæä¾›ç»™ç³»ç»Ÿç®¡ç†å‘˜è®¾ç½®å·¥ä½œæ—¥çš„åŠŸèƒ½ï¼Œé»˜è®¤æ˜¯æ¯ä¸ªæœˆå‘¨ä¸€è‡³å‘¨äº”æ˜¯å·¥ä½œæ—¥ï¼Œå‘¨å…­è‡³å‘¨æ—¥æ˜¯éå·¥ä½œæ—¥ï¼ˆèŠ‚å‡æ—¥æš‚æ—¶ä¸è€ƒè™‘ï¼‰ï¼Œç®¡ç†å‘˜å¯ä»¥åœ¨è¿™ä»½åŸºç¡€é…ç½®ä¸Šåšä¿®æ”¹ï¼Œæ¯”å¦‚9æœˆä»½çš„ç¬¬äºŒä¸ªå‘¨äº”æ˜¯è°ƒä¼‘ï¼Œåˆ™å°†é‚£ä¸€å¤©è®¾ç½®æˆéå·¥ä½œæ—¥ã€‚
+ è®¾ç½®æµç¨‹ï¼š
    1. åœ¨é€‰æ‹©æœˆä»½ä¹‹åï¼Œä¼šè°ƒæ¥å£æŸ¥è¯¢å½“æœˆçš„å·¥ä½œæ—¥é…ç½®ä¿¡æ¯ï¼ˆç¬¬ä¸‰æ–¹çš„æ¥å£ï¼Œåº“é‡Œåªè®°å½•å·¥ä½œæ—¥è®¾ç½®é¡¹ï¼Œå³å¦‚æœæŸ¥è¯¢çš„æœˆä»½è®¾ç½®è¿‡å·¥ä½œæ—¥ï¼Œæ‰ä¼šæœ‰è®°å½•ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¿‡ï¼Œåˆ™é‚£ä¸ªæœˆä»½æŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œä¸ä¼šè¿”å›é»˜è®¤çš„å·¥ä½œæ—¥é…ç½®ğŸ¤·â€ï¼‰
    2. æŸ¥è¯¢åˆ°æ•°æ®åˆ™æ ¹æ®æ¥å£æ•°æ®æ¸²æŸ“
    3. æ²¡æœ‰æŸ¥åˆ°åˆ™éœ€è¦**åœ¨å‰ç«¯ç”Ÿæˆä¸€ä»½é»˜è®¤çš„å·¥ä½œæ—¥é…ç½®**ç”¨äºæ¸²æŸ“

## éš¾ç‚¹

å¯¹äºç®¡ç†å‘˜æ²¡æœ‰è®¾ç½®è¿‡çš„æœˆä»½ï¼Œå¦‚ä½•åœ¨å‰ç«¯é’ˆå¯¹ä¸åŒçš„æœˆä»½å»ç”Ÿæˆåˆå§‹å·¥ä½œæ—¥æ•°æ®ï¼Ÿ

## éœ€æ±‚è§£è¯»

1. ç”Ÿæˆä¸€ä»½é…ç½®ç”¨äºæ¸²æŸ“ï¼Œå·¥ä½œæ—¥è®¾ç½®æˆè“è‰²ï¼Œéå·¥ä½œæ—¥è®¾ç½®æˆé»„è‰²
2. å…·ä½“ä¸€ç‚¹å°±æ˜¯æ˜ŸæœŸä¸€è‡³æ˜ŸæœŸäº”è®¾ç½®æˆè“è‰²ï¼Œæ˜ŸæœŸå…­è‡³æ˜ŸæœŸæ—¥è®¾ç½®æˆé»„è‰²
3. å°±è¿™æ„å‘³ç€éœ€è¦å°†å½“æœˆçš„æ¯ä¸€å¤©è·Ÿæ˜ŸæœŸï¼ˆæ˜ŸæœŸä¸€ï¼š1ï¼Œæ˜ŸæœŸæ—¥ï¼š7ï¼‰è”ç³»èµ·æ¥ï¼Œå†æ ¹æ®**å½“å¤©çš„æ˜ŸæœŸæ˜¯å¦å¤§äº5**æ¥åŒºåˆ†æ˜¯å¦æ˜¯å·¥ä½œæ—¥

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†éœ€æ±‚ç†è§£ä¸ºç”Ÿæˆä¸€ä»½åˆ—è¡¨ï¼Œé‡Œé¢å­˜æ”¾**æŸä¸€ä¸ªæœˆæ¯ä¸€å¤©çš„æ—¥æœŸä¸æ˜ŸæœŸçš„å…³è”æ•°æ®**ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨é—®é¢˜è½¬æ¢æˆäº†æ€æ ·å°†ä¸€ä¸ªæœˆæ¯ä¸€å¤©çš„æ—¥æœŸä¸æ˜ŸæœŸåšå…³è”ï¼ï¼

## è®¾è®¡æ€è·¯

ä»¥ä¸‹æ˜¯æˆ‘çš„æ€è€ƒè¿‡ç¨‹ï¼š

ç°åœ¨ï¼Œæˆ‘ä»¬ç°æœ‰çš„æ•°æ®å°±åªæ˜¯ç”¨æˆ·é€‰æ‹©äº†å“ªä¸€å¹´å“ªä¸€ä¸ªæœˆä»½

ä¸ºäº†å°†æ—¥æœŸä¸æ˜ŸæœŸåšå…³è”ï¼Œæˆ‘ä»¬æœ€èµ·ç å¾—çŸ¥é“è¿™ä¸ªæœˆæœ‰å¤šå°‘å¤©ï¼Œè¿™ä¸ªæœˆç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ ...ç­‰ç­‰ä¸€äº›åŸºæœ¬æ•°æ®ï¼Œè¿™äº›éƒ½å¥½åŠ
```js
/**
 * è·å–æŸæœˆä»½çš„æ€»å¤©æ•°
 * @param {Number} mouth æœŸæœ›è·å–çš„æœˆä»½ï¼ˆ1ï¼šä¸€æœˆï¼Œ2ï¼šäºŒæœˆï¼‰
 */
const getDays = mouth => {
    const date = new Date();
    // å°†å½“å‰æœˆä»½è®¾ç½®åˆ°æœŸæœ›è·å–æœˆä»½çš„ä¸‹ä¸€ä¸ªæœˆï¼ˆè¿™é‡Œåªéœ€è¦å°†ä¼ å…¥çš„æœˆä»½è®¾ç½®ä¸Šå³å¯ï¼Œå› ä¸ºæœ¬èº«ä¼ å…¥çš„æœˆä»½å°±æ˜¯ç´¢å¼•å€¼åŠ 1ï¼‰
    date.setMonth(mouth);
    // å°†å½“å‰çš„æ—¥æœŸç½®ä¸º0
    date.setDate(0);
    // å†è·å–å¤©æ•°å³å–ä¸Šä¸ªæœˆçš„å¤©æ•°
    return date.getDate();
}

/**
 * è·å–æŸæœˆç¬¬ä¸€å¤©çš„æ˜ŸæœŸæ•°ï¼ˆæ˜ŸæœŸä¸€ï¼š1ï¼Œæ˜ŸæœŸæ—¥ï¼š7ï¼‰
 * @param {Number} year æœŸæœ›è·å–çš„å¹´ä»½
 * @param {Number} mouth æœŸæœ›è·å–çš„æœˆä»½
 */
const getFirstDayWeek = (year, mouth) => new Date(year, mouth - 1).getDay() || 7;
```

æœ‰äº†è¿™äº›æˆ‘ä»¬ä¾ç„¶æ¯«æ— å¤´ç»ªï¼Œé‚£ä¹ˆæ¢ä¸ªè§’åº¦æ¥æ€è€ƒä¸€ä¸‹æœ€ç»ˆæˆ‘ä»¬æœŸæœ›çš„ç›®æ ‡æ•°æ®ç»“æ„å¤§æ¦‚æ˜¯å•¥æ ·çš„

å°±æ¯”å¦‚æˆ‘ä»¬æƒ³è¦çš„ä¹æœˆçš„æ—¥å†åˆ—è¡¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½å¸Œæœ›æœ€ç»ˆçš„åˆ—è¡¨é‡Œæœ‰ `æ—¥æœŸ`ï¼ˆdayï¼‰ã€`æ˜ŸæœŸ`ï¼ˆweekï¼‰ã€`æ˜¯å¦æ˜¯å·¥ä½œæ—¥`ï¼ˆisWorkï¼Œè¿™ä¸ªå…¶å®å¯ä»¥é€šè¿‡æ˜ŸæœŸåŠ ä¸Šä¸ªè£…é¥°å™¨å®ç°ï¼‰ï¼Œç±»ä¼¼äºä¸‹é¢è¿™æ ·:
```js
// ä¹æœˆ
[
    { day: 1, week: 7, isWork: false },
    { day: 2, week: 1, isWork: true },
    { day: 3, week: 2, isWork: true },
    { day: 4, week: 3, isWork: true },
    { day: 5, week: 4, isWork: true },
    { day: 6, week: 5, isWork: true },
    { day: 7, week: 6, isWork: false },
    { day: 8, week: 7, isWork: false },
    { day: 9, week: 1, isWork: true },
    { day: 10, week: 2, isWork: true },
    { day: 11, week: 3, isWork: true },
    { day: 12, week: 4, isWork: true },
    ...
]
```

ä¼¼ä¹çœ‹è§äº†æ›™å…‰ï¼ï¼è¿™é‡Œçš„ `day` å’Œ `week` è²Œä¼¼æ˜¯æœ‰è§„å¾‹å¯å¾ªçš„ï¼ï¼Ÿ

## ç¡®è®¤æ•°æ®ç»“æ„åŠç®—æ³•

+ æ€è·¯ä¸€ï¼š `day` å’Œ `week` åº”è¯¥æ˜¯å¯ä»¥æ‰¾åˆ°**æ˜ å°„å…³ç³»**çš„

    å…ˆçœ‹çœ‹å‡ ä¸ªå…³é”®çš„å€¼ï¼š
    + é™¤å»å½“æœˆå¤´å‡ å¤©ï¼Œä»å½“æœˆçš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸä¸€å¼€å§‹çœ‹ï¼ˆå¯¹åº”ä¸Šé¢ä¹æœˆçš„ `{ day: 2, week: 1, isWork: true }` ï¼‰ï¼Œç¬¬ä¸€ä¸ªæ˜ŸæœŸä¸€é‚£å¤© `day` å’Œ `week` çš„å·®å€¼ï¼ˆä¹æœˆå¯¹åº”çš„æ˜¯ `2 - 1 = 1` ï¼‰ï¼Œæš‚ä¸”å«å®ƒ `diff` 
    + å½“æœˆçš„å®Œæ•´å‘¨çš„ï¼ˆä¹æœˆä¸­ä»2å·å¼€å§‹ç®—ç¬¬ä¸€ä¸ªå®Œæ•´å‘¨ï¼‰ï¼Œæš‚ä¸”å«å®ƒ `weekIndex`

    æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹å…¬å¼ï¼š`week = day - 7 * (weekIndex - 1) - diff` ï¼ˆåº”è¯¥æœ‰å…¶ä»–è§„å¾‹ï¼Œå¹¼ç¨šçš„æˆ‘åªèƒ½çœ‹å‡ºè¿™æ ·ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼‰

    soï¼Ÿè¿™ä¹Ÿå¤ªå¤æ‚äº†ï¼ï¼è€Œä¸”å°±ç®—æ˜¯ç”¨ä»£ç è½åœ°å‡ºæ¥äº†ï¼Œç”¨å³è„šå¤§æ‹‡æŒ‡ä¹Ÿèƒ½æƒ³è±¡çš„åˆ°å¯è¯»æ€§éå¸¸ä½

+ æ€è·¯äºŒï¼šæ‰¾æ‰¾ `week` å­—æ®µè‡ªå·±çš„è§„å¾‹

    è§‚å¯Ÿä¸€ä¸‹ `day` å’Œ `week` å­—æ®µ
    +  `day` æ˜¯ä»1å¼€å§‹è‡ªå¢çš„ï¼ˆæ¸¯åºŸç“¦ï¼‰ï¼š1-2-3-4-5-6-7-8-9...
    +  `week` æ˜¯ä»1åˆ°7å¾ªç¯å‡ºç°çš„ï¼š1-2-3-4-5-6-7-1-2-3-4...

    å¾ªç¯å‡ºç°çš„ -> å¤´è·Ÿå°¾ç›¸è¿ -> **å¾ªç¯é“¾è¡¨**ï¼ï¼ï¼

    æ˜æœ—äº†ï¼æˆ‘ä»¬å¯ä»¥é€ ä¸€ä¸ª `week` çš„å¾ªç¯é“¾è¡¨
    +  `week` å¾ªç¯é“¾è¡¨çš„ `head` æŒ‡é’ˆ**åˆå§‹åŒ–åœ¨å½“æœˆçš„ç¬¬ä¸€å¤©çš„æ˜ŸæœŸæ•°**ï¼ˆä¹æœˆå¯¹åº”çš„æ˜¯æ˜ŸæœŸäºŒï¼Œåˆ™ `head` æŒ‡é’ˆåˆå§‹åŒ–åœ¨æ˜ŸæœŸäºŒï¼‰
    + å¾ªç¯ä¸€ä¸ªåˆ—è¡¨ï¼ˆä»1å¼€å§‹ï¼Œå¤§å°ä¸ºå½“æœˆå¤©æ•°ï¼‰ï¼Œåˆ—è¡¨ä¸­ `day` å³ä¸ºå¾ªç¯ç´¢å¼•å€¼ï¼Œ `week` å³ä¸ºå½“å‰çš„å¾ªç¯é“¾è¡¨çš„ `head` æŒ‡é’ˆæŒ‡å‘çš„å€¼ï¼Œå¾ªç¯çš„æœ«å°¾æ›´æ–° `head` æŒ‡é’ˆçš„ä½ç½®

## å®ç°

è½åœ°æˆä»£ç ï¼š
```js
// ç”±äºå…³äºæ˜ŸæœŸçš„æ•°æ®å®é™…ä¸Šæ˜¯æ°¸ä¹…åŒ–çš„ï¼Œä¸å­˜åœ¨æ’å…¥å’Œåˆ é™¤
// æ‰€ä»¥è¿™é‡Œå¯ä»¥å·ä¸ªå°æ‡’ï¼Œç”¨å­—å…¸ä»£æ›¿å¾ªç¯é“¾è¡¨ï¼Œ
// key ä»£è¡¨æ˜ŸæœŸæ•°
// value æŒ‡å‘ä¸‹ä¸€ä¸ªæ˜ŸæœŸæ•°
const dict = {
    '1': '2',
    '2': '3',
    '3': '4',
    '4': '5',
    '5': '6',
    '6': '7',
    '7': '1'
}

/**
 * è·å–æŸæœˆæ—¥æœŸä¸æ˜ŸæœŸå…³è”åˆ—è¡¨
 * @param {Number} year æŸ¥è¯¢å¹´ä»½
 * @param {Number} mouth æŸ¥è¯¢æœˆä»½
 */
const getCalendar = (year, mouth) => {

    // å½“æœˆå¤©æ•°
    const _days = getDays(mouth);
    // å½“æœˆç¬¬ä¸€å¤©çš„æ˜ŸæœŸæ•°
    const _firstDayWeek = getFirstDayWeek(year, mouth);
    // æ—¥æœŸé˜Ÿåˆ—
    const _temp = [];
    // åˆå§‹åŒ–å½“å‰æ˜ŸæœŸå·ï¼ˆå¯¹åº” head æŒ‡é’ˆï¼‰
    let _curWeek = _firstDayWeek + '';

    for (let i = 1; i <= _days; i++) {
        _temp.push({
            day: i,                     // å¤©
            week: _curWeek,             // æ˜ŸæœŸæ•°
            isWork: +_curWeek <= 5      // æ˜¯å¦æ˜¯å·¥ä½œæ—¥
        });
        // æ›´æ–°å½“å‰æ˜ŸæœŸå·ï¼ˆæ›´æ–° head æŒ‡é’ˆï¼‰
        _curWeek = dict[_curWeek];
    }
    return _temp;
};
```

å½“ç„¶ï¼Œä¸Šè¿°æ€è·¯å½“ç„¶ä¹Ÿä¸æ˜¯å”¯ä¸€çš„ï¼Œè‚¯å®šè¿˜æœ‰åˆ«çš„æ›´å¥½çš„æ–¹å¼~

æ‰§è¡Œç»“æœï¼š
![æ‰§è¡Œç»“æœ1](/blog/img/date-algo/result1.jpg)
![éªŒè¯1](/blog/img/date-algo/cal1.jpg)
![æ‰§è¡Œç»“æœ2](/blog/img/date-algo/result2.jpg)
![éªŒè¯2](/blog/img/date-algo/cal2.jpg)

æ‰€ä»¥ï¼Œåˆ«å†è¯´å‰ç«¯å­¦ç®—æ³•ç”¨ä¸ä¸Šäº†ğŸ¤ª
