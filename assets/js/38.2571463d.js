(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{351:function(v,_,t){"use strict";t.r(_);var a=t(0),r=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h2",{attrs:{id:"整体概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#整体概念"}},[v._v("#")]),v._v(" 整体概念")]),v._v(" "),t("h4",{attrs:{id:"对比工厂和工人"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对比工厂和工人"}},[v._v("#")]),v._v(" 对比工厂和工人")]),v._v(" "),t("ul",[t("li",[v._v("类似于一个工厂，有自己独立的资源（系统为进程分配的独立内存）")]),v._v(" "),t("li",[v._v("工厂之间相互独立（进程之间相互独立）")]),v._v(" "),t("li",[v._v("工厂中有一个或多个工人（进程管理一个或多个线程程）")]),v._v(" "),t("li",[v._v("多个工人协作完成任务（进程中的线程互相协作）")]),v._v(" "),t("li",[v._v("工人之间共享工厂资源（同一进程下的各个线程之间共享程序的内存空间：包括代码段、数据集、堆等）")])]),v._v(" "),t("h4",{attrs:{id:"官方一些的描述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官方一些的描述"}},[v._v("#")]),v._v(" 官方一些的描述")]),v._v(" "),t("ul",[t("li",[v._v("进程\n"),t("ul",[t("li",[v._v("是cpu资源分配的最小单位（是能拥有资源和独立运行的最小单位）")]),v._v(" "),t("li",[v._v("不同进程之间可以通信，代价较大")]),v._v(" "),t("li",[v._v("浏览器每打开一个 tab 页，就相当于创建了一个独立的浏览器进程（浏览器有自己的优化机制，某些契机下会合并进程）")])])]),v._v(" "),t("li",[v._v("线程\n"),t("ul",[t("li",[v._v("是cpu调度的最小单位")]),v._v(" "),t("li",[v._v("是建立在进程的基础上的一次程序运行单位")]),v._v(" "),t("li",[v._v("一个进程中可以有多个线程")]),v._v(" "),t("li",[v._v("线程之间各司其职、互相协作，共同完成一个进程中的工作")])])])]),v._v(" "),t("h2",{attrs:{id:"浏览器多进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器多进程"}},[v._v("#")]),v._v(" 浏览器多进程")]),v._v(" "),t("h3",{attrs:{id:"包含的主要进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#包含的主要进程"}},[v._v("#")]),v._v(" 包含的主要进程")]),v._v(" "),t("p",[v._v("浏览器中包含的主要进程：")]),v._v(" "),t("blockquote",[t("ol",[t("li",[t("em",[v._v("浏览器主进程")])]),v._v(" "),t("li",[t("em",[v._v("第三方插件进程")])]),v._v(" "),t("li",[t("em",[v._v("GPU进程")])]),v._v(" "),t("li",[t("em",[v._v("渲染进程（浏览器内核）")])])])]),v._v(" "),t("p",[v._v("可以打开 Chrome 的 "),t("code",[v._v("更多工具")]),v._v(" -> "),t("code",[v._v("任务管理器")]),v._v(" 查看")]),v._v(" "),t("h4",{attrs:{id:"浏览器主进程（唯一）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器主进程（唯一）"}},[v._v("#")]),v._v(" 浏览器主进程（唯一）")]),v._v(" "),t("ul",[t("li",[v._v("浏览器中起管理作用：\n"),t("ol",[t("li",[v._v("界面显示、用户交互（前进，后退等）的管理")]),v._v(" "),t("li",[v._v("各页面进程的管理")]),v._v(" "),t("li",[v._v("其他进程创建和销毁的管理")]),v._v(" "),t("li",[v._v("网络资源的管理与下载")])])]),v._v(" "),t("li",[v._v("与渲染相关的作用：\n"),t("ul",[t("li",[v._v("将渲染进程（内核）得到的内存中的 Bitmap ，绘制到用户界面")])])])]),v._v(" "),t("h4",{attrs:{id:"第三方插件进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三方插件进程"}},[v._v("#")]),v._v(" 第三方插件进程")]),v._v(" "),t("ul",[t("li",[v._v("每种类型的插件对应一个进程")]),v._v(" "),t("li",[v._v("仅当使用该插件时才创建")])]),v._v(" "),t("h4",{attrs:{id:"gpu进程（唯一）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gpu进程（唯一）"}},[v._v("#")]),v._v(" GPU进程（唯一）")]),v._v(" "),t("ul",[t("li",[v._v("用于3D绘制等")])]),v._v(" "),t("h4",{attrs:{id:"渲染进程（每个tab页一个）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#渲染进程（每个tab页一个）"}},[v._v("#")]),v._v(" 渲染进程（每个tab页一个）")]),v._v(" "),t("ul",[t("li",[v._v("又称为 "),t("strong",[v._v("浏览器内核")])]),v._v(" "),t("li",[v._v("流行的浏览器内核\n"),t("ul",[t("li",[t("strong",[v._v("WebKit")]),v._v(" - 原Chrome、Safari")]),v._v(" "),t("li",[t("strong",[v._v("Blink")]),v._v(" - Chrome")]),v._v(" "),t("li",[t("strong",[v._v("Gecko")]),v._v(" - Firefox")]),v._v(" "),t("li",[t("strong",[v._v("Trident")]),v._v(" - IE（不开源）")])])]),v._v(" "),t("li",[v._v("每个渲染进程之间互不影响")]),v._v(" "),t("li",[v._v("主要作用：\n"),t("ul",[t("li",[v._v("页面渲染")]),v._v(" "),t("li",[v._v("脚本执行")]),v._v(" "),t("li",[v._v("事件处理")])])])]),v._v(" "),t("h3",{attrs:{id:"浏览器多进程的优势"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器多进程的优势"}},[v._v("#")]),v._v(" 浏览器多进程的优势")]),v._v(" "),t("ol",[t("li",[v._v("避免单个页面、插件崩溃导致浏览器崩溃")]),v._v(" "),t("li",[v._v("多进程充分利用多核优势")]),v._v(" "),t("li",[v._v("方便使用沙盒模型隔离插件等进程，提高浏览器稳定性")])]),v._v(" "),t("h3",{attrs:{id:"渲染进程中包含的常驻线程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#渲染进程中包含的常驻线程"}},[v._v("#")]),v._v(" 渲染进程中包含的常驻线程")]),v._v(" "),t("p",[v._v("一个浏览器渲染进程中包含的常驻线程：")]),v._v(" "),t("blockquote",[t("ol",[t("li",[t("em",[v._v("界面渲染线程")])]),v._v(" "),t("li",[t("em",[v._v("JS引擎线程")])]),v._v(" "),t("li",[t("em",[v._v("事件触发线程（异步任务队列）")])]),v._v(" "),t("li",[t("em",[v._v("定时触发器线程")])]),v._v(" "),t("li",[t("em",[v._v("异步http请求线程")])])])]),v._v(" "),t("h4",{attrs:{id:"界面渲染线程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#界面渲染线程"}},[v._v("#")]),v._v(" 界面渲染线程")]),v._v(" "),t("ul",[t("li",[v._v("负责浏览器界面渲染，解析 HTML 构建DOM树，解析 CSS 构建CSSOM树 等")]),v._v(" "),t("li",[v._v("重绘（Repaint）、回流（reflow）")]),v._v(" "),t("li",[v._v("与 "),t("strong",[v._v("JS引擎线程")]),v._v(" 互斥，JS引擎线程有任务执行时，界面渲染线程将被挂起（GUI更新会被保存在一个队列中），等到JS引擎线程空闲时立即执行执行")]),v._v(" "),t("li",[v._v("互斥的原因：JS引擎执行的脚本有可能修改UI界面，"),t("strong",[v._v("界面渲染")]),v._v("与"),t("strong",[v._v("脚本执行")]),v._v("同时进行时可能导致渲染出错")])]),v._v(" "),t("h4",{attrs:{id:"js引擎线程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#js引擎线程"}},[v._v("#")]),v._v(" JS引擎线程")]),v._v(" "),t("ul",[t("li",[v._v("又叫 "),t("em",[v._v("js内核")]),v._v("（一个进程中唯一）")]),v._v(" "),t("li",[v._v("js单线程："),t("strong",[v._v("一个渲染进程中唯一存在一个JS引擎线程")])]),v._v(" "),t("li",[v._v("流行的js引擎\n"),t("ul",[t("li",[t("strong",[v._v("SpiderMonkey")]),v._v("（Mozilla） - 第一款JavaScript引擎")]),v._v(" "),t("li",[t("strong",[v._v("TraceMonkey")]),v._v("（Mozilla） - 基于实时编译的引擎")]),v._v(" "),t("li",[t("strong",[v._v("V8")]),v._v("（Google） - Chrome、NodeJS使用的js引擎")]),v._v(" "),t("li",[t("strong",[v._v("KJS")]),v._v("（Konqueror） - KDE的ECMAScript/JavaScript引擎")])])]),v._v(" "),t("li",[v._v("负责处理Javascript脚本程序")]),v._v(" "),t("li",[v._v("JS引擎的表现形式：循环查看当前队列中是否存在事件需要执行，当JS引擎线程闲置时，会去事件触发线程查看是否存在异步事件，有则拉取过来作为一次循环再次执行")]),v._v(" "),t("li",[v._v("JS引擎的一次循环被称为一次"),t("strong",[v._v("宏任务")]),v._v("执行")]),v._v(" "),t("li",[v._v("与 "),t("strong",[v._v("界面渲染线程")]),v._v(" 互斥，JS引擎线程 将阻塞 界面渲染线程")])]),v._v(" "),t("h4",{attrs:{id:"事件触发线程（异步任务队列）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事件触发线程（异步任务队列）"}},[v._v("#")]),v._v(" 事件触发线程（异步任务队列）")]),v._v(" "),t("ul",[t("li",[v._v("归属于浏览器")]),v._v(" "),t("li",[v._v("控制事件循环（可以理解，JS引擎自己都忙不过来，需要浏览器另开线程协助）")]),v._v(" "),t("li",[v._v("引擎读取到的异步（setTimeout）、事件脚本（click），会将对应任务添加到事件线程中")]),v._v(" "),t("li",[v._v("当保存的任务符合条件触发时，事件触发线程会将事件添加到 -> "),t("u",[v._v("待处理队列的"),t("strong",[v._v("队尾")]),v._v("，等待"),t("strong",[v._v("JS引擎线程")]),v._v("空闲时处理")])])]),v._v(" "),t("h4",{attrs:{id:"定时触发器线程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定时触发器线程"}},[v._v("#")]),v._v(" 定时触发器线程")]),v._v(" "),t("ul",[t("li",[t("code",[v._v("setInterval")]),v._v(" 与 "),t("code",[v._v("setTimeout")]),v._v(" 所在线程")]),v._v(" "),t("li",[v._v("通过单独线程来计时并触发定时")]),v._v(" "),t("li",[v._v("当触发定时器时，定时触发器线程会将事件添加到 -> "),t("u",[t("strong",[v._v("事件触发线程")]),v._v("的待处理队列的"),t("strong",[v._v("队尾")]),v._v("，等待"),t("strong",[v._v("JS引擎线程")]),v._v("空闲时处理")])]),v._v(" "),t("li",[v._v("tip: W3C标准中规定：要求setTimeout中低于4ms的时间间隔算为4ms")])]),v._v(" "),t("h4",{attrs:{id:"异步http请求线程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#异步http请求线程"}},[v._v("#")]),v._v(" 异步http请求线程")]),v._v(" "),t("ul",[t("li",[v._v("在 XMLHttpRequest 在连接后是通过浏览器新开一个线程请求")]),v._v(" "),t("li",[v._v("将检测到状态变更时，如果设置有回调函数，异步线程就"),t("strong",[v._v("产生状态变更事件")]),v._v("，将这个回调添加到 -> "),t("u",[t("strong",[v._v("事件触发线程")]),v._v("的待处理队列的"),t("strong",[v._v("队尾")]),v._v("，等待"),t("strong",[v._v("JS引擎线程")]),v._v("空闲时处理")])])]),v._v(" "),t("h3",{attrs:{id:"浏览器主进程与渲染进程的通信"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器主进程与渲染进程的通信"}},[v._v("#")]),v._v(" 浏览器主进程与渲染进程的通信")]),v._v(" "),t("p",[t("img",{attrs:{src:"/blog/img/browser/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1.jpeg",alt:"浏览器进程通信"}})]),v._v(" "),t("p",[v._v("打开一个浏览器的线程通信：")]),v._v(" "),t("ol",[t("li",[v._v("浏览器主进程收到用户请求，首先需要获取页面内容（譬如通过网络下载资源），随后将该任务通过RendererHost接口传递给界面渲染进程")]),v._v(" "),t("li",[v._v("界面渲染进程的Renderer接口收到消息，简单解释后，交给渲染线程，然后开始渲染")]),v._v(" "),t("li",[v._v("渲染线程经由界面渲染进程帮助计算元素位置、排列、绘制，得到结果（Bitmap）")]),v._v(" "),t("li",[v._v("浏览器主进程收到结果（Bitmap）将其渲染出来")])])])}),[],!1,null,null,null);_.default=r.exports}}]);